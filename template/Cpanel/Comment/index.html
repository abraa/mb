<div id="toolbar">
    <table class="form" width="100%">
        <tr>
            <td>
                <a class="easyui-linkbutton" iconCls="fa fa-angle-double-down" plain="true" onclick="onExport({})">导出报表</a>
            </td>
            <td align="right">
            	<input class="easyui-combobox" name="tag_id" id="tag_id" method="get" data-options="url:'{:U('CommentTag/select')}',valueField:'id',textField:'text'" value="0" style="width:150px;">
            	<select name="is_satisfy" id="is_satisfy" class="easyui-combobox" style="width: 80px;">
                	<option value="-1">是否满意</option>
                	<option value="1">满意</option>
                    <option value="0">不满意</option>
                </select>
                <input id="employee_id" class="easyui-textbox" data-options="prompt:'请输入员工工号...'" style="width:150px;">
                <input id="employee_name" class="easyui-textbox" data-options="buttonText:'搜索',prompt:'请输入员工姓名...',buttonIcon:'icon-search',onClickButton:onSearch" style="width:180px;">
            </td>
        </tr>
    </table>
</div>
<table id="grid" width="100%">
    <thead>
    <tr>
        <th data-options="field:'employee_id', sortable:true,width:20">员工工号</th>
        <th data-options="field:'employee_name', sortable:true,width:20">员工姓名</th>
        <th data-options="field:'is_satisfy',width:20, sortable:true,align:'center', formatter: function(value){
        return value == '1' ? '<font color=green>满意</font>' : '<font color=red>不满意</font>';
    }">是否满意</th>
    	<th data-options="field:'tag_names', sortable:true,width:60">标签</th>
        <th data-options="field:'content', sortable:true,width:60">评价内容</th>
        <th data-options="field:'create_time', sortable:true,width:30">添加时间</th>
    </tr>
    </thead>
</table>
<script type="text/javascript">
    var grid = $('#grid');
    var rowId = 0;
    $(function(){
        easyui.treegrid({
            element:grid,
            onDblClickRow: function(row){
                onOpen(row);
            }
        });
    });

    function onOpen(row) {
		shadow.options.buttons =[{
			text: ' 关闭 ',
			iconCls: 'fa fa-ban',
			handler: function(){
				shadow.destroy();
			}
		}];
        var opts = {
            href: '{:U("form")}',
            width: '70%',
            data: row,
            handler: function(result){
                //grid.treegrid('reload');
            }
        };
        shadow.open(opts);
    }
	function onExport() {
		shadow.options.buttons =[];
        var opts = {
            href: '{:U("export")}',
            width: '70%',
            handler: function(result){
                //grid.treegrid('reload');
            }
        };
        shadow.open(opts);
    }
	function onSearch() {
        grid.treegrid('reload', {
			tag_id: $('#tag_id').combobox('getValue'),
			is_satisfy: $('#is_satisfy').combobox('getValue'),
			employee_id: $('#employee_id').val(),
			employee_name: $('#employee_name').val()
        });
    }
</script>